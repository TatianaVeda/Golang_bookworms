<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Posts in {{.CategoryName}}</title>
    <link rel="stylesheet" href="/static/home.css">
    <link rel="icon" href="/static/images/lion-icon.png" type="image/png">
</head>
<body>
    <div class="back-home">
        <a href="/" class="home-button">Home üè†</a>
    </div>

    <div class="container">
        <div class="posts-section">
            <!-- Category Name -->
            <h1 class="category-name">All Posts in Category {{.CategoryName}}</h1>

            <!-- Posts List -->
            {{if .Posts}}
                {{range .Posts}}
                <div class="post">
                    <!-- Post Title -->
                    <h2 class="post-title">{{.Title}}</h2>
                    <!-- Post Body -->
                    <p class="post-body">{{.Body}}</p>
                    <!-- User who posted -->
                    <p class="post-user">Posted by: {{.UserName}}</p>
                    <!-- Category Name -->
                    <p class="post-category">Category: {{.CategoryName}}</p>

                <!-- <div class="comments">
                <p>Comments:</p>
                <ul>{{range .Comments}}
                    <div class="comment"></div>
                    <li><p>{{.Body}} </p>/</li>
                    <small>Posted by: {{.UserName}} on {{.CreatedAt}}</small>
                    <form method="post" action="/comments/like">
                        <input type="hidden" name="comment_id" value="{{.ID}}">
                        <button type="submit">üëç Likes: {{.LikeCount}},| Dislikes: {{.DislikeCount}}</button>
                    </form>
                      </div>
                  </ul>
                    {{end}} -->
                
               <!-- Likes and Dislikes -->
                {{if $.IsLoggedIn}}
                    <p>Likes: {{.LikeCount}} | Dislikes: {{.DislikeCount}}</p>
                    <form action="/posts/update_like_dislike" method="POST" style="display:inline;">
                        <input type="hidden" name="post_id" value="{{.ID}}">
                        <input type="hidden" name="category_id" value="{{$.CategoryID}}"> <!-- Pass Category ID -->
                        <input type="hidden" name="like_type" value="1">
                        <button type="submit" class="like-button">Likeü§©</button>
                    </form>
                    <form action="/posts/update_like_dislike" method="POST" style="display:inline;">
                        <input type="hidden" name="post_id" value="{{.ID}}">
                        <input type="hidden" name="category_id" value="{{$.CategoryID}}"> <!-- Pass Category ID -->
                        <input type="hidden" name="like_type" value="-1">
                        <button type="submit" class="dislike-button">Dislikeüëø</button>
                    </form>
                    <form action="/posts" method="POST">
                        <input type="hidden" name="post_id" value="{{.ID}}">
                        <textarea name="body" placeholder="Leave a comment..." required></textarea>
                        <button type="submit">Add Comment</button>
                    </form>
                   

                  <div class="comments">
                    <h3>Comments:</h3>
                        {{range .Comments}}
                        <div class="comment">
                            <p>{{.Body}}</p>
                            <strong>Posted by: {{.Poster}}:</strong> {{.Body}} <br>
                            <li>{{.Body}} - User ID: {{.UserID}}</li>
                            <small>on {{.CreatedAt}} –õ–∞–π–∫–æ–≤: {{.LikeCount}}, –î–∏–∑–ª–∞–π–∫–æ–≤: {{.DislikeCount}}</small>
                            <form method="post" action="/posts">
                                <input type="hidden" name="comment_id" value="{{.ID}}">
                                <button type="submit">üëç Like ({{.LikeCount}})</button>
                            </form>
                        </div>
                        {{end}}
                {{else}}
                    <p><em>Log in to see like/dislike counts and interact with posts.</em></p>
                {{end}}
                <!-- Comments for the current post -->
                <div class="comments-section">
                    <h3>Comments</h3>
                    {{if .Comments}}
                        {{range .Comments}}
                        <div class="comment">
                            <p>{{.Body}} - <strong>{{.UserName}}</strong></p> <!-- Display comment body and username -->
                        </div>
                        {{end}}
                    {{else}}
                        <p>No comments yet. Be the first to comment!</p>
                    {{end}}

                    <!-- Add a new comment -->
                    {{if $.IsLoggedIn}}
                        <form action="/posts/comment" method="POST">
                            <input type="hidden" name="post_id" value="{{.ID}}">
                            <textarea name="body" placeholder="Write your comment..." required></textarea>
                            <button type="submit">Comment</button>
                        </form>
                    {{else}}
                        <p><em>Log in to comment.</em></p>
                    {{end}}
                </div>

                <hr>
            </div>
            {{end}}
            {{else}}
                <p>No posts found in this category. Please create a new post to get started!</p>
            {{end}}
        </div>
    </div>
    <iframe name="hidden_iframe" style="display:none;"></iframe>
    <div class="footer">
        <p>&copy; 2024 Literary Lions Forum</p>
    </div>
</body>
</html>
