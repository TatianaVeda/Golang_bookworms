<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Posts in {{.CategoryName}}</title>
    <link rel="stylesheet" href="/static/home.css">
    <link rel="icon" href="/static/images/lion-icon.png" type="image/png">
</head>
<body>
    <div class="header">
        <img src="/static/images/lion-icon.png" alt="Logo" class="logo">
        <h1> Feeling your inner-r-rr-rrr lion?</h1>
    </div>
    <div class="back-home">
        <a href="/" class="home-button">Home üè†</a>
    </div>
    <div class="container">
        <div class="posts-section">
            <!-- Category Name -->
            <h1 class="category-name">All Posts in {{.CategoryName}}</h1>

            <div class="posts-grid">
            {{if .Posts}}
                {{range .Posts}}
                <div class="post">
                    <!-- Post Title -->
                    <h2 class="post-title">{{.Title}}</h2>
                    <!-- Post Body -->
                    <p class="post-body">{{.Body}}</p>
                    <!-- User who posted -->
                    <p class="post-user">Posted by: {{.UserName}}</p>
                    <!-- Category Name -->
                    <p class="post-category">Category: {{.CategoryName}}</p>
                    <!-- Likes and Dislikes -->
                    <p>Likes: {{.LikeCount}} | Dislikes: {{.DislikeCount}}</p>
                   
                
                <!-- Interaction options for logged-in users -->
                {{if $.IsLoggedIn}}
                        <form action="/posts/update_like_dislike" method="POST" style="display:inline;">
                        <input type="hidden" name="post_id" value="{{.ID}}">
                        <input type="hidden" name="category_id" value="{{$.CategoryID}}">
                        <input type="hidden" name="like_type" value="1">
                        <button type="submit" class="like-button">Like ü§©</button>
                    </form>
                    
                    <form action="/posts/update_like_dislike" method="POST">
                        <input type="hidden" name="post_id" value="{{.ID}}">
                        <input type="hidden" name="category_id" value="{{$.CategoryID}}">
                        <input type="hidden" name="like_type" value="-1">
                        <button type="submit" class="dislike-button">Dislikeüëø</button>
                    </form>
                    {{else}}
                        <p><em><a href="/">Log in</a> to interact with posts or comments, to like/dislike.></em></p>
                    {{end}}

                     <!-- Comments Section -->
                    <div class="comments-section">
                        <p>Comments:</p>
                        {{if .Comments}}        
                        <ul>
                            {{range .Comments}}
                             <li>
                                <p>{{.Body}} - <strong>{{.UserName}}</strong></p> <!-- Display comment body and username -->
                                        <small><p><em>Commented by: {{.Poster}} at: {{.CreatedAtFormatted}}</em></p></small>
                                        <small><p>ü§© Likes: {{.LikeCount}} üëø Dislikes: {{.DislikeCount}}</p></small>
                                        
                                        <!-- Interaction options for logged-in users -->
                                        {{if $.IsLoggedIn}}
                                        <form action="/like_comment" method="POST" style="display:inline;">
                                            <input type="hidden" name="comment_id" value="{{ .ID }}">
                                            <button type="submit" name="like_type" value="1">Like ü§©</button>
                                            <button type="submit" name="like_type" value="-1">Dislike üëø</button>
                                        </form>
                                        {{end}}                                   
                                    </li>
                                    {{end}} 
                                </ul>
                                {{else}}                                  
                                    <p>No comments yet. Be the first to comment!</p>
                                {{end}}

                    <!-- Comment Form for Logged-In Users -->                     
                    {{if $.IsLoggedIn}}
                    <form action="/posts/comment" method="POST">
                        <input type="hidden" name="post_id" value="{{ .ID }}">
                        <textarea name="body" placeholder="Leave a comment..." required></textarea>
                        <button type="submit">Add Comment</button>
                    </form>
                    {{end}}
                </div>
            </div>
            {{end}}            
        {{else}}
            <p>No posts found in this category. Please create a new post to get started!</p>
            {{end}}
        </div>

        <iframe name="hidden_iframe" style="display:none;"></iframe>
    </div>
</div>
</div>
    <hr>
    <iframe name="hidden_iframe" style="display:none;"></iframe>
    <div class="footer">
        <p>&copy; 2024 Literary Lions Forum</p>
    </div>
</body>
</html>